set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${GLOW_BINARY_DIR}/tests/)
add_subdirectory(Testing)
add_subdirectory(unittests)
add_subdirectory(images)
add_subdirectory(benchmark)
add_subdirectory(models)

# Set the lit configuration variables that are specific to that build.
# This is used to generate the proper set of "REQUIRES" features
# (e.g. opencl, cpu).
set(FLIT_CONFIG_AUX_FILE "${CMAKE_CURRENT_SOURCE_DIR}/flit_cfg_aux.py.in")
set(FLIT_CONFIG_AUX_HEADER
"## Autogenerated from ${FLIT_CONFIG_AUX_FILE}\n## Do not edit.\n")
set(AUX_FLIT_CONFIG_FILE ${CMAKE_CURRENT_BINARY_DIR}/flit_cfg_aux.py)
set(LIT_INVOCATION python ${CMAKE_CURRENT_SOURCE_DIR}/flit.py ${AUX_FLIT_CONFIG_FILE} ${CMAKE_CURRENT_SOURCE_DIR}/flit_cfg.py)
set(FILECHECKER_COMMAND "python ${CMAKE_CURRENT_SOURCE_DIR}/filechecker.py")

configure_file(${FLIT_CONFIG_AUX_FILE} ${AUX_FLIT_CONFIG_FILE} @ONLY)

add_custom_target(litTests
                  COMMAND ${LIT_INVOCATION}
                  WORKING_DIRECTORY ${CMAKE_BINARY_DIR})
add_glow_test(NAME litTests
              COMMAND ${LIT_INVOCATION}
              WORKING_DIRECTORY ${CMAKE_BINARY_DIR}
              DEPENDS text-translator)
